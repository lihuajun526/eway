<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>完善信息</title>
    <link rel="stylesheet" href="/images/animate.min.css">   
    <link rel="stylesheet"  href="/images/bootstrap.css">
 <!--*************************bootstrap css end************************-->   
    <link rel="stylesheet" href="/images/global_v2.0.0.css"/>
    <link rel="stylesheet" href="/images/wt_index.css"/>
 <!--*************************创建项目的主链接************************-->     
    <link rel="stylesheet" href="/images/project.css"/>
    <script type="text/javascript" src="/jquery/jquery-1.11.1.js"></script>
<script type="text/javascript" src="/js/config.js"></script>

</head>
<body>
<!--*************************头部************************-->
<div class="g-top">
   <div class="g-logo"></div>
   <div class="g-link">
      <ul>
        <li class="on"><a href="#">首页</a></li>
        <li><a href="#">项目</a></li>
        <li><a href="#">投资人</a></li>
        <li><a href="#">活动</a></li>
      </ul>
   </div>
   <div class="g-login">
      <ul>
         <li class="on3"><a href="#"><img src="/images/wt-top3.png"/></a></li>
         <li class="on2"><a href="#">创建项目</a></li>
         <li class="on1"><a href="#">购买服务</a></li>
      </ul>
   </div>
</div>

<!--*************************main************************-->
<div class="pro-body">
    <div class="pro-wap">   
            <div class="pro-t">完善信息(1/2)</div>
            <div class="empty"></div>
            <div class="pro-one">        
               <ul class="pro-one-lst">
                   <li class="on1">手机号码</li>
                   <li class="on2"><input type="text" id="mobile" class="pro-one-ipt" placeholder="手机号码"/></li>
                </ul>
            </div>
            <div class="pro-one">        
               <ul class="pro-one-lst">
                   <li class="on1">短信验证码</li>
                   <li class="on2"><input type="text" id="smsCode" class="pro-one-ipt" placeholder="手机验证码"/><span onclick="getSmsCode()" class="pro-one-getyzm"><a >获取验证码</a></span>
                    <!--<span class="g-ove"><a href="#">倒计时54秒</a></span>-->
                   </li>
                </ul>
            </div>
            <div id="userMesage" style="display:none">
	            <div class="pro-one">        
	               <ul class="pro-one-lst">
	                   <li class="on1">真实姓名</li>
	                   <li class="on2">
	                      <ul>
	                         <li><input id="name" type="text" class="pro-one-ipt" placeholder="姓名"/></li>
	                      </ul>
	                     <div class="pro-six-janj-2">详细的团队成员信息，可以让投资人透彻的
	了解团队的组成情况，团队中每位成员的亮
	点都能为项目起到加分的作用</div>
	                      
	                   </li>
	                </ul>
	            </div>
	            <div class="pro-one">        
	               <ul class="pro-one-lst">
	                   <li class="on1">邮箱</li>
	                   <li class="on2"><input id="email" type="text" class="pro-one-ipt" placeholder="邮箱地址"/></li>
	                </ul>
	            </div>
	            <div class="pro-one">        
	               <ul class="pro-one-lst">
	                   <li class="on1"></li>
	                   <li class="on2">
	                       <ul class="pro-one-lst2">
	                          <li><input name="type" type="radio" value="3"></li>
	                          <li class="pro-radio">创业/创业者</li>
	                          <li><input name="type" type="radio" value="4"></li>
	                          <li class="pro-radio">投资人</li>
	                       </ul>
	                   </li>
	                </ul>
	            </div>
            </div>
            <div class="pro-clear"></div>  
           
  <!--*************************下一步按钮************************-->   
           <div class="pro-clear"></div>             
           <div id="toBind" class="pro-btn"><a onclick="toBind()">绑定</a></div>      
           <div id="updateUser" class="pro-btn" style="display:none"><a onclick="updateUser()">下一步</a></div>      
     </div>
</div>            
<!--*************************footer************************-->

<div class="g-foot">
   <div class="g-conter">
       <div class="g-foot-l">
          <div class="g-fl-t">
             <span class="g-fl-tit"></span>
             <h3>MUX倾力打造的矢量图标管理、交流平台。设计师将图标上传到Iconfont平台，用户可以自定义下载多种格式的icon，平台也可将图标。</h3>
          </div>
          <ul class="g-fl-lst">
            <li><a href="#">服务条款</a></li>
            <li><a href="#">服务条款</a></li>
            <li><a href="#">服务条款</a></li>
            <li><a href="#">服务条款</a></li>
          </ul>
          <div class="g-fl-Remarks">服务热线:020-32039118  /   粤ICP备14063324号  /  ©2</div>
       </div>
       <div class="g-foot-r">
          <div class="g-fr-t">友情链接</div>
          <ul class="g-fr-lst">
            <li><a href="#">THX</a></li>
            <li><a href="#">阿里妈妈MUX</a></li>
            <li><a href="#">钱庄网</a></li>
            <li><a href="#">网易财经</a></li>
            <li><a href="#">21财经</a></li>
            <li><a href="#">虎嗅</a></li>
            <li><a href="#">36kr</a></li>
            <li><a href="#">搜狐财经</a></li>
            <li><a href="#">新浪网</a></li>
          </ul>
          <div class="g-fr-ewm">不错过任何一个好产品<span><img src="/images/wt-ewm.png"/></span></div>
       </div>
       
       
   </div>
   
</div>
</body>
<script type="text/javascript">
var openid;
var nickname;
$(function(){
	openid = sessionStorage.getItem("openid");
	nickname = sessionStorage.getItem("nickname");
})
function getSmsCode() {
	var mobile = $("#mobile").val();
    if (mobile == "") {
        alert("请填写手机号");
        return;
    }
    $.get(appName + "/sms/get/" + mobile + "?type=regist&openid=" + openid, function (result) {
        alert(result.message);
    }, "json");
}
//绑定响应函数
function toBind(){
	if($("#mobile").val() == ""){
		alert("请填写手机号");
	}
	if($("#smsCode").val() == ""){
		alert("请填写验证码");
	}
	var sendData = {
		"smsCode":$("#smsCode").val(),
		"mobile":$("#mobile").val(),
		"openid":openid,
		"nickname":nickname
	};
	$.ajax({
        type: 'get',
        dataType: 'json',
        url: appName + "/weChat/regist",
        data:sendData,
        success: function (data) {
        	if(data.success){
        		var result = data.data;
        		if(result.roleid != null){
        			//若该手机号原本就是平台账号则前往首页
                	window.location.href = "/index";
        		}else{
        			//若该手机号为新用户则继续完善个人信息
        			$("#userMesage").show();
        			$("#updateUser").show();
        			$("#toBind").hide();
        		}
        	}else{
        		alert("验证码错误");
        	}
        }
    });
}
//下一步响应函数
function updateUser(){
	var sendData = {
		"name":$("#name").val(),
		"email":$("#email").val(),
		"roleid":$("input[name='type']:checked").val()
	};
	$.ajax({
        type: 'get',
        dataType: 'json',
        url: appName + "/user/update",
        data:sendData,
        success: function (data) {
        	if(data.success){
        		alert("提交成功");
//         		window.location.href = "";
        	}
        }
    });
}
</script>
</html>